---
// [slug].astro

import Layout from "../../layouts/Layout.astro";
import AmazonLogo from "../../components/AmazonLogo.astro";
import BuyButton from "../../components/BuyButton.astro";

// Define la URL de la API
const API_URL = "https://admin.nicolascarrillo.com/api/courses";

// Función para obtener todos los cursos
export async function getStaticPaths() {
  const response = await fetch(API_URL);
  const data = await response.json();
  const courses = data.docs;

  return courses.map((course: any) => ({
    params: { slug: course.slug },
    props: { course },
  }));
}

// Recupera el curso desde las props
const { course } = Astro.props;
const {
  id,
  title,
  slug,
  estado,
  descripcionCurso,
  precio,
  coverImage,
  recetas,
} = course;

// Renderiza el contenido adicional si es necesario
// (Puedes agregar más lógica aquí según tus necesidades)

export const prerender = true;
---

<Layout title={`${title} - Cursos de Cocina`}>
  <div class="flex flex-col lg:flex-row gap-12">
    <aside class="flex flex-col items-center gap-6">
      <a href="/" class="hover:underline opacity-70">← Volver atrás</a>
      <img class="rounded w-72 h-auto" alt={`Portada de ${title}`} />

      <div class="text-center">
        <span class="text-lg font-semibold">Precio: ${precio}€</span>
      </div>

      <BuyButton id={id} precio={precio} />
    </aside>

    <main class="max-w-3xl">
      <h1 class="text-4xl font-bold mb-4">{title}</h1>
      <p class="mb-6">
        {descripcionCurso || "Descripción del curso no disponible."}
      </p>

      <h2 class="text-2xl font-semibold mb-2">Recetas Incluidas:</h2>
    </main>
  </div>
</Layout>
